# `fork()` 函数

## 一. `fork`函数

### 函数原型

fork()函数在 C 语言中的原型如下：

```c
#include <unistd.h>
pid_t fork(void);
```

其中pid_t是一个整型数据类型，用于表示进程ID。fork()函数返回值是一个pid_t类型的值，具体含义如下：

- 如果调用fork()的进程是父进程，则返回子进程的进程ID（PID）。
- 如果调用fork()的进程是子进程，则返回0。
- 如果出现错误，fork()返回-1。

通过检查fork()函数的返回值，可以判断当前代码是在父进程中还是在子进程中，并根据不同的返回值执行不同的代码逻辑。

### 函数特性

fork()函数具有以下几个特性：

- **创建子进程**：fork()函数用于创建一个与父进程几乎完全相同的子进程。子进程从fork()函数的返回处开始执行，而父进程继续执行fork()之后的代码。
- **独立的执行环境**：父进程和子进程在fork()后分别独立地执行，彼此之间的执行是相互独立的。它们有各自的内存空间和资源管理，所以它们的状态互不干扰。
- **返回值区分**：根据fork()函数的返回值，可以在父进程和子进程中执行不同的代码逻辑。在父进程中，fork()返回子进程的进程ID（PID），在子进程中，fork()返回0。通过判断返回值，可以实现父子进程的不同分支逻辑。
- **共享和隔离的资源**：父进程和子进程之间通过fork()函数共享某些资源，如打开的文件描述符。这意味着它们可以共享一些数据和状态。但同时，子进程是父进程的副本，它们之间的修改不会相互影响，各自拥有独立的虚拟内存空间。
- **进程树的形成**：通过反复调用fork()函数，可以创建更多的子进程，从而形成进程树结构。子进程可以再次调用fork()创建更多的子进程，形成更复杂的进程关系和层次结构。